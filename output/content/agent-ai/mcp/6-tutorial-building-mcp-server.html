<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><title>Tutorial: Building a Minimal MCP Server in Python</title><script src="https://cdn.tailwindcss.com"></script><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&amp;display=swap" rel="stylesheet"/><style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .code-block {
            background-color: #1a202c; /* gray-900 */
            color: #e2e8f0; /* gray-300 */
            padding: 1.5rem;
            border-radius: 0.75rem;
            font-family: 'Menlo', 'Monaco', 'Consolas', 'Liberation Mono', 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
            overflow-x: auto;
        }
        .code-block .token.comment { color: #a0aec0; } /* gray-500 */
        .code-block .token.keyword { color: #f6ad55; } /* orange-400 */
        .code-block .token.string { color: #68d391; } /* green-400 */
        .code-block .token.function { color: #63b3ed; } /* blue-400 */
        .code-block .token.number { color: #f687b3; } /* pink-400 */
        .code-block .token.punctuation { color: #cbd5e0; } /* gray-400 */
        .code-block .token.class-name { color: #f6e05e; } /* yellow-400 */
    </style></head><body class="bg-gray-50 text-gray-800"><div class="container mx-auto px-4 sm:px-6 lg:px-8 py-12"><header class="text-center mb-12"><h1 class="text-4xl md:text-5xl font-bold text-gray-900 leading-tight">Tutorial: Building a Minimal MCP Server</h1><p class="mt-4 text-lg md:text-xl text-gray-600 max-w-3xl mx-auto">A Step-by-Step Guide Using Python and FastAPI</p></header><main class="max-w-4xl mx-auto"><section class="mb-12"><p class="text-lg leading-relaxed">
                    This walkthrough shows you how to set up a minimalist Model Context Protocol (MCP) server from the ground up. We'll make a server with a single "tool," then build a simple LLM agent client to use it. For our demo, the tool will provide weather information.
                </p></section><section class="mb-12 bg-white p-8 rounded-2xl shadow-sm border border-gray-200"><h2 class="text-2xl font-bold text-gray-900 mb-4">Prerequisites</h2><p>You'll need Python 3.7+ installed. We'll be using the <a class="text-indigo-600 hover:underline" href="https://fastapi.tiangolo.com/">FastAPI</a> framework for our server and `requests` for our client.</p><div class="code-block mt-4"><pre><code><span class="token comment"># Install the necessary libraries</span>
pip install "fastapi[all]" uvicorn python-multipart requests</code></pre></div></section><section class="mb-16" id="step-by-step"><h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">Step-by-Step Guide</h2><div class="mb-10"><h3 class="text-2xl font-semibold text-gray-800 mb-3"><span class="text-indigo-600">Step 1:</span> Define the Tool Logic</h3><p class="mb-4">First, we'll define the main function our server will expose. It's a simple Python function. Make a file called `tools.py`.</p><div class="code-block"><pre><code><span class="token comment"># tools.py</span><span class="token keyword">import</span> random

<span class="token keyword">def</span><span class="token function">get_weather</span><span class="token punctuation">(</span>location<span class="token punctuation">:</span><span class="token class-name">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">Here is a rewritten line of similar size:

'''A sample function to retrieve weather data for a specified place.'''</span><span class="token keyword">if</span><span class="token string">"tokyo"</span><span class="token keyword">in</span> location<span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token keyword">return</span><span class="token punctuation">{</span><span class="token string">"location"</span><span class="token punctuation">:</span><span class="token string">"Tokyo"</span><span class="token punctuation">,</span><span class="token string">"temperature"</span><span class="token punctuation">:</span><span class="token string">"15°C"</span><span class="token punctuation">,</span><span class="token string">"condition"</span><span class="token punctuation">:</span><span class="token string">"Cloudy"</span><span class="token punctuation">}</span>
    
    temps <span class="token punctuation">=</span><span class="token punctuation">[</span><span class="token string">"25°C"</span><span class="token punctuation">,</span><span class="token string">"-5°C"</span><span class="token punctuation">,</span><span class="token string">"30°C"</span><span class="token punctuation">]</span>
    conditions <span class="token punctuation">=</span><span class="token punctuation">[</span><span class="token string">"Sunny"</span><span class="token punctuation">,</span><span class="token string">"Snowing"</span><span class="token punctuation">,</span><span class="token string">"Rainy"</span><span class="token punctuation">]</span><span class="token keyword">return</span><span class="token punctuation">{</span><span class="token string">"location"</span><span class="token punctuation">:</span> location<span class="token punctuation">,</span><span class="token string">"temperature"</span><span class="token punctuation">:</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>temps<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">"condition"</span><span class="token punctuation">:</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span>conditions<span class="token punctuation">)</span><span class="token punctuation">}</span></code></pre></div></div><div class="mb-10"><h3 class="text-2xl font-semibold text-gray-800 mb-3"><span class="token keyword text-indigo-600">Step 2:</span> Build the MCP Server</h3><p class="mb-4">Set up a server to expose this tool through an API endpoint—this forms our MCP logic. Name the file `server.py`.</p><div class="code-block"><pre><code><span class="token comment"># server.py</span><span class="token keyword">from</span> fastapi <span class="token keyword">import</span> FastAPI
<span class="token keyword">from</span> pydantic <span class="token keyword">import</span> BaseModel
<span class="token keyword">from</span> typing <span class="token keyword">import</span> Dict<span class="token punctuation">,</span> Any
<span class="token keyword">from</span> tools <span class="token keyword">import</span> get_weather

app <span class="token punctuation">=</span><span class="token function">FastAPI</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># This defines the expected input for our endpoint</span><span class="token keyword">class</span><span class="token class-name">ToolCallRequest</span><span class="token punctuation">(</span>BaseModel<span class="token punctuation">)</span><span class="token punctuation">:</span>
    tool_name<span class="token punctuation">:</span> str
    parameters<span class="token punctuation">:</span> Dict<span class="token punctuation">[</span>str<span class="token punctuation">,</span> Any<span class="token punctuation">]</span><span class="token comment"># Our "tool registry" is just a simple dictionary</span>
AVAILABLE_TOOLS <span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token string">"get_weather"</span><span class="token punctuation">:</span> get_weather
<span class="token punctuation">}</span><span class="token decorator"><span class="token punctuation">@</span>app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">"/tools/call"</span><span class="token punctuation">)</span><span class="token keyword">def</span><span class="token function">call_tool</span><span class="token punctuation">(</span>request<span class="token punctuation">:</span> ToolCallRequest<span class="token punctuation">)</span><span class="token punctuation">:</span>
    tool_function <span class="token punctuation">=</span> AVAILABLE_TOOLS<span class="token punctuation">.</span>get<span class="token punctuation">(</span>request<span class="token punctuation">.</span>tool_name<span class="token punctuation">)</span><span class="token keyword">if</span><span class="token keyword">not</span> tool_function<span class="token punctuation">:</span><span class="token keyword">return</span><span class="token punctuation">{</span><span class="token string">"error"</span><span class="token punctuation">:</span><span class="token string">"Tool not found"</span><span class="token punctuation">}</span><span class="token comment"># Call the actual tool function with its parameters</span>
    result <span class="token punctuation">=</span> tool_function<span class="token punctuation">(</span><span class="token operator">**</span>request<span class="token punctuation">.</span>parameters<span class="token punctuation">)</span><span class="token keyword">return</span><span class="token punctuation">{</span><span class="token string">"status"</span><span class="token punctuation">:</span><span class="token string">"success"</span><span class="token punctuation">,</span><span class="token string">"result"</span><span class="token punctuation">:</span> result<span class="token punctuation">}</span></code></pre></div></div><div class="mb-10"><h3 class="text-2xl font-semibold text-gray-800 mb-3"><span class="token keyword text-indigo-600">Step 3:</span> Create the LLM Agent Client</h3><p class="mb-4">This agent mimics an LLM choosing a tool. It takes a prompt, picks the relevant tool, and sends a request to our MCP server. Create `agent.py`.</p><div class="code-block"><pre><code><span class="token comment"># agent.py</span><span class="token keyword">import</span> requests
<span class="token keyword">import</span> json

MCP_SERVER_URL <span class="token punctuation">=</span><span class="token string">"http://127.0.0.1:8000/tools/call"</span><span class="token keyword">def</span><span class="token function">run_agent</span><span class="token punctuation">(</span>prompt<span class="token punctuation">:</span><span class="token class-name">str</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    print<span class="token punctuation">(</span><span class="token string">f"Agent received prompt: '{prompt}'"</span><span class="token punctuation">)</span><span class="token comment"># --- This part simulates the LLM's reasoning ---</span>
    tool_name <span class="token punctuation">=</span><span class="token string">"get_weather"</span>
    parameters <span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token string">"location"</span><span class="token punctuation">:</span><span class="token string">"Tokyo"</span><span class="token punctuation">}</span>
    print<span class="token punctuation">(</span><span class="token string">f"LLM decided to call tool '{tool_name}' with params {parameters}"</span><span class="token punctuation">)</span><span class="token comment"># --- End of simulation ---</span><span class="token comment"># Construct the request to the MCP server</span>
    payload <span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token string">"tool_name"</span><span class="token punctuation">:</span> tool_name<span class="token punctuation">,</span><span class="token string">"parameters"</span><span class="token punctuation">:</span> parameters
    <span class="token punctuation">}</span><span class="token keyword">try</span><span class="token punctuation">:</span>
        response <span class="token punctuation">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>MCP_SERVER_URL<span class="token punctuation">,</span> json<span class="token punctuation">=</span>payload<span class="token punctuation">)</span>
        response<span class="token punctuation">.</span>raise_for_status<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token comment"># Raise an exception for bad status codes</span>
        
        result <span class="token punctuation">=</span> response<span class="token punctuation">.</span>json<span class="token punctuation">(</span><span class="token punctuation">)</span>
        print<span class="token punctuation">(</span><span class="token string">"\n--- Server Response ---"</span><span class="token punctuation">)</span>
        print<span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>result<span class="token punctuation">,</span> indent<span class="token punctuation">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">except</span> requests<span class="token punctuation">.</span>exceptions<span class="token punctuation">.</span>RequestException <span class="token keyword">as</span> e<span class="token punctuation">:</span>
        print<span class="token punctuation">(</span><span class="token string">f"\nError calling MCP server: {e}"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span><span class="token string">"__main__"</span><span class="token punctuation">:</span>
    user_prompt <span class="token punctuation">=</span><span class="token string">"What's the weather like in Tokyo today?"</span><span class="token function">run_agent</span><span class="token punctuation">(</span>user_prompt<span class="token punctuation">)</span></code></pre></div></div><div><h3 class="text-2xl font-semibold text-gray-800 mb-3"><span class="token keyword text-indigo-600">Step 4:</span> Run the Demo</h3><p class="mb-4">Open two terminal windows. In the first, start the server.</p><div class="code-block"><pre><code><span class="token comment"># Terminal 1: Run the server</span>
uvicorn server:app --reload</code></pre></div><p class="my-4">In the second terminal, run the agent client.</p><div class="code-block"><pre><code><span class="token comment"># Terminal 2: Run the agent</span>
python agent.py</code></pre></div><p class="my-4">The agent will show its chosen action, followed by the JSON response received from the server!</p></div></section><section class="text-center mt-16"><h2 class="text-3xl font-bold text-gray-900 mb-4">You've Built an MCP Server!</h2><p class="text-lg leading-relaxed max-w-3xl mx-auto">
                    Great job! You’ve built the basic pieces of an agentic system. This pattern—an API server for tools and a client to use them—is central to MCP. Next, you can expand with extra tools, add resource controls, and develop advanced agent logic.
                </p></section></main><html><head></head><body><footer class="bg-gray-800 text-gray-300"><div class="container mx-auto px-6 py-12 lg:px-8"><div class="grid grid-cols-1 gap-8 md:grid-cols-2 lg:grid-cols-4"><div><h5 class="text-lg font-semibold text-white mb-4">Company</h5><ul class="space-y-2"><li><a class="hover:text-white hover:underline transition-colors duration-200" href="https://www.dataknobs.com/about-dataknobs/">About Us</a></li><li><a class="hover:text-white hover:underline transition-colors duration-200" href="https://www.dataknobs.com/products/value-proposition/">Value Proposition</a></li><li><a class="hover:text-white hover:underline transition-colors duration-200" href="https://www.dataknobs.com/blog/">Blog</a></li><li><a class="hover:text-white hover:underline transition-colors duration-200" href="https://www.dataknobs.com/use-cases/">Use Cases Built</a></li><li><a class="hover:text-white hover:underline transition-colors duration-200" href="https://www.dataknobs.com/about-dataknobs/leadership/">Founder</a></li></ul></div><div><h5 class="text-lg font-semibold text-white mb-4">Products</h5><ul class="space-y-2"><li><a class="hover:text-white hover:underline transition-colors duration-200" href="https://www.dataknobs.com/products/kreate/">Kreate</a></li><li><a class="hover:text-white hover:underline transition-colors duration-200" href="https://www.dataknobs.com/products/kontrols/">Kontrols</a></li><li><a class="hover:text-white hover:underline transition-colors duration-200" href="https://www.dataknobs.com/products/knobs/">Knobs</a></li><li><a class="hover:text-white hover:underline transition-colors duration-200" href="https://www.dataknobs.com/use-cases/">Case Studies</a></li></ul></div><div><h5 class="text-lg font-semibold text-white mb-4">Slides Tutorials</h5><ul class="space-y-2"><li><a class="hover:text-white hover:underline transition-colors duration-200" href="https://www.dataknobs.com/generativeai/generative-ai-101-slides.html">GenAI Slides</a></li><li><a class="hover:text-white hover:underline transition-colors duration-200" href="https://www.dataknobs.com/agent-ai/tutorials.html">Agent AI Slides</a></li><li><a class="hover:text-white hover:underline transition-colors duration-200" href="https://www.dataknobs.com/vector-database/">Vector DB Slides</a></li><li><a class="hover:text-white hover:underline transition-colors duration-200" href="https://www.dataknobs.com/generativeai/10-llms/">LLM Slides</a></li><li><a class="hover:text-white hover:underline transition-colors duration-200" href="https://www.dataknobs.com/data-products/">Data Product Slides</a></li><li><a class="hover:text-white hover:underline transition-colors duration-200" href="https://www.dataknobs.com/generativeai/10-llms/rag/">RAG Slides</a></li></ul></div><div><h5 class="text-lg font-semibold text-white mb-4">Contact Us</h5><div class="space-y-2"><p>Redmond<br/>WA, USA</p><p><a class="hover:text-white hover:underline transition-colors duration-200" href="mailto:contact@dataknobs.com">contact@dataknobs.com</a></p><p><a class="hover:text-white hover:underline transition-colors duration-200" href="tel:+14253411222">+1 (425) 341-1222</a></p></div></div></div><div class="mt-12 border-t border-gray-700 pt-8 flex flex-col items-center justify-between sm:flex-row"><p class="text-sm text-gray-400">© 2025 Dataknobs, Inc. All rights reserved.</p><div class="flex space-x-4 mt-4 sm:mt-0"><a class="text-gray-400 hover:text-white transition-colors duration-200" href="https://www.facebook.com/dataknobs/"><span class="sr-only">Facebook</span><svg aria-hidden="true" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path clip-rule="evenodd" d="M22 12c0-5.523-4.477-10-10-10S2 6.477 2 12c0 4.991 3.657 9.128 8.438 9.878v-6.987h-2.54V12h2.54V9.797c0-2.506 1.492-3.89 3.777-3.89 1.094 0 2.238.195 2.238.195v2.46h-1.26c-1.243 0-1.63.772-1.63 1.562V12h2.773l-.443 2.89h-2.33v6.988C18.343 21.128 22 16.991 22 12z" fill-rule="evenodd"></path></svg></a><a class="text-gray-400 hover:text-white transition-colors duration-200" href="https://www.twitter.com/dataknobs/"><span class="sr-only">Twitter</span><svg aria-hidden="true" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path d="M8.29 20.251c7.547 0 11.675-6.253 11.675-11.675 0-.178 0-.355-.012-.53A8.348 8.348 0 0022 5.92a8.19 8.19 0 01-2.357.646 4.118 4.118 0 001.804-2.27 8.224 8.224 0 01-2.605.996 4.107 4.107 0 00-6.993 3.743 11.65 11.65 0 01-8.457-4.287 4.106 4.106 0 001.27 5.477A4.072 4.072 0 012.8 9.713v.052a4.105 4.105 0 003.292 4.022 4.095 4.095 0 01-1.853.07 4.108 4.108 0 003.834 2.85A8.233 8.233 0 012 18.407a11.616 11.616 0 006.29 1.84"></path></svg></a><a class="text-gray-400 hover:text-white transition-colors duration-200" href="https://www.linkedin.com/company/dataknobs/"><span class="sr-only">LinkedIn</span><svg aria-hidden="true" class="h-6 w-6" fill="currentColor" viewBox="0 0 24 24"><path clip-rule="evenodd" d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.783-1.75-1.75s.784-1.75 1.75-1.75 1.75.783 1.75 1.75-.784 1.75-1.75 1.75zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z" fill-rule="evenodd"></path></svg></a></div></div></div></footer></body></html></div></body></html>